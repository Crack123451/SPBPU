clc;
k1 = 3*1.5;
k2 = 2;
k3 = -4;
k4 = -4;
t = 0.0001;
Tf = 20;

a00 = (1+k2*k3+k1)/k2;
a01 = -k2*k4;
a10 = (k1-k2+k1*k2*k3+k1*k1)/k2;
a11 = -(1+k2*k3+k1)/k2;

k1d = 3;
k2d = 2;
k3d = -4;
k4d = -4;

a00d = (1+k2d*k3d+k1d)/k2d;
a01d = -k2d*k4d;
a10d = (k1d-k2d+k1d*k2d*k3d+k1d*k1d)/k2d;
a11d = -(1+k2d*k3d+k1d)/k2d;

M = [1 1];
B = [1;0;0;0];
C = [0 0 1 0;0 0 0 1];
D = [0;0];

A = [k3, 0, 0, k4; 1, 0, 0, 0; 0, 1, 0, 0; k2, k1, 1, 0];
b1 = -M*(C*B);
b0 = -(M*(C*A)+[a10 a11]*C)*B;


Ad = [k3d, 0, 0, k4d; 1, 0, 0, 0; 0, 1, 0, 0; k2d, k1d, 1, 0];
b1d = -M*(C*B);
b0d = -(M*(C*Ad)+[a10d a11d]*C)*B;